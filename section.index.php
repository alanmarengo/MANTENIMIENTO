<div id="page_index">
    <div id="main-slider" class="carousel slide" data-ride="carousel" data-interval="3000">
        <ol class="carousel-indicators">
            <li data-target="#main-slider" data-slide-to="0" class="active"></li>
            <li data-target="#main-slider" data-slide-to="1"></li>
            <li data-target="#main-slider" data-slide-to="2"></li>
            <li data-target="#main-slider" data-slide-to="3"></li>
            <li data-target="#main-slider" data-slide-to="4"></li>
            <li data-target="#main-slider" data-slide-to="5"></li>
        </ol>
        <div class="carousel-inner">
            <a href="./page_proyecto.php" class="carousel-item active">
                <img class="d-block w-100" src="./images/index/s1.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Energía renovable</p>
                </div>
                <div class="slide-hover">
                    Cóndor Cliff y La Barrancosa aportarán energía renovable para todo el país, aumentando en un 12% la
                    potencia hidráulica instalada.
                </div>
            </a>

            <a href="./page_pdga.php?target=glaciares" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s2.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Protección de glaciares</p>
                </div>
                <div class="slide-hover">
                    El desacople hidráulico entre Cóndor Cliff y el Lago Argentino protege a los glaciares de las
                    fluctuaciones del embalse.
                </div>
            </a>

            <a href="./page_pdga.php?target=aves" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s3.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Macá tobiano</p>
                </div>
                <div class="slide-hover">
                    La operación de La Barrancosa no afectará al estuario del río Santa Cruz, preservando de esta manera
                    la zona de invernada del macá tobiano.
                </div>
            </a>

            <a href="./page_pdga.php?target=peces" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s4.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Peces del Santa Cruz</p>
                </div>
                <div class="slide-hover">
                    Los estudios sobre lamprea y otras especies aportan información para conservar a las poblaciones de
                    peces y a la pesca como una actividad de relevancia.
                </div>
            </a>

            <a href="./page_pdga.php?target=articulacion" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s5.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Participación pública</p>
                </div>
                <div class="slide-hover">
                    El acceso a la información y el trabajo articulado con las instituciones locales permiten involucrar
                    a todos los sectores sociales interesados en el proyecto.
                </div>
            </a>

            <a href="./page_pdga.php?target=apectos" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s6.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Desarrollo regional</p>
                </div>
                <div class="slide-hover">
                    La ejecución de las obras, la mayor disponibilidad de energía y los recursos técnicos que se
                    incorporan en la provincia fortalecen las perspectivas de desarrollo.
                </div>
            </a>
        </div>

        <div class="carousel-control-prev2" href="#main-slider" role="button" data-slide="prev">
            <i class="fa fa-chevron-left"></i>
        </div>
        <div class="carousel-control-next2" href="#main-slider" role="button" data-slide="next">
            <i class="fa fa-chevron-right"></i>
        </div>
    </div>


    <div class="row">
        <div class="col-md-10">
            <div class="row modulo-row">
                
                <!-- #1 -->
                <div class="col-md-6 modulo-wrap-caja1">

                    <video id="uxVideo2" class="videosize" poster="./images/index/caja1.jpg">
                        <source src="http://observatorio.atic.com.ar/video_3d/LB_3.mp4" type="video/mp4" />
                    </video>
                
                
                    <!--  <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        Aprovechamientos Hidroeléctricos del Río Santa Cruz
                    </div>
                    <div class="modulo-hover">
                    </div> -->
                </div>

                <!-- #2 -->
                <a href="./page_pdga.php" class="col-md-6 modulo-wrap modulo-2">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        Plan de Gestión Ambiental
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Plan de sostenibilidad del proyecto, monitoreos sistemáticos de las variables ambientales con visión de cuenca y enfocados en el largo plazo.                            <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>
            </div>

            <div class="row modulo-row">
                <!-- #3 -->
                <div id="noticias-slider" class="carousel slide col-md-12" data-ride="false" data-interval="false" style="padding-left: 0px; padding-right: 0px;"></div>
            </div>

            <div class="row modulo-row">
                
                <!-- #4 -->
                <a href="./page_endesarrollo.php?q=Participación pública y gestión social" class="col-md-6 modulo-wrap modulo-4">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        Participación pública y gestión social
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Acceso a la información, participación pública, seguimiento de variables sociales y articulación con actores del territorio.                             <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>

                <!-- #5 -->
                <a href="./page_endesarrollo.php?q=Manejo integrado de cuenca" class="col-md-6 modulo-wrap modulo-5">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        Manejo integrado de cuenca
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Estudios, análisis y datos de los recursos de la cuenca del río Santa Cruz en base al enfoque de manejo integrado.                             <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>
            </div>

            <div class="row modulo-row">

                <!-- #6 -->
                <a href="./page_endesarrollo.php?q=Gestión ambiental de obra" class="col-md-6 modulo-wrap modulo-6" style="width: 50%;">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        Gestión ambiental de obra
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Gestión de los aspectos ambientales en obra, higiene y seguridad, política de calidad en los procesos y gestión del riesgo. 
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>

                <div class="col-md-6">
                    <div class="row">

                        <!-- #7 -->
                        <a href="./page_endesarrollo.php?q=Patrimonio natural y cultural" class="col-md-12 modulo-wrap modulo-7">
                            <div class="modulo-opacity"></div>
                            <div class="modulo-text">
                                Patrimonio natural y cultural
                            </div>
                            <div class="modulo-hover">
                                <p class="modulo-hover-text">
                                    Patrimonio arqueológico, paleontológico, geológico y preservación de la naturaleza. 
                                    <br />
                                    <span class="modulo-hover-icon">
                                        <i class="fa fa-plus-circle fa-2x"></i>
                                    </span>
                                </p>
                            </div>
                        </a>
                        
                        <!-- #8 -->
                        <a href="./page_esia.php" class="col-md-12 modulo-wrap modulo-8">
                            <div class="modulo-opacity"></div>
                            <div class="modulo-text">
                                Antecedentes y marco legal
                            </div>
                            <div class="modulo-hover">
                                <p class="modulo-hover-text">
                                    Línea de base ambiental, estudios de impacto y normativa aplicable al proyecto. 
                                    <br />
                                    <span class="modulo-hover-icon">
                                        <i class="fa fa-plus-circle fa-2x"></i>
                                    </span>
                                </p>
                            </div>
                        </a>

                    </div>
                </div>
            </div>

            <div class="row modulo-row border-bottom">
                
                <!-- #9 -->
                <div class="col-md-4 modulo-wrap modulo-9">
                    <div id="uxSensor"></div>
                </div>
                
                <!-- #10 -->
                <a href="./geovisor.php?geovisor=2" class="col-md-4 modulo-wrap modulo-10">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        Visor de información geográfica 
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Mapas temáticos del proyecto, de las obras en construcción, de la información ambiental y de monitoreos y actividades en ejecución. 
                            <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>

                <!-- #11 -->
                <a href="./geovisor.php?geovisor=1" class="col-md-4 modulo-wrap modulo-11">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        SIG Santa Cruz
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Información espacial de la provincia de Santa Cruz orientada a la gestión y análisis de políticas públicas en diversas temáticas.                             <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>
            </div>
        </div>


        <div class="col-md-2 side-right" style="position: relative;">
            <div class="row pinned" style="position: absolute;">
                <a 
                    href="./mediateca.php" 
                    class="col-md-12 link-icon" 
                    data-img="./images/index/icon1a.png"
                    data-imghover="./images/index/icon1b.png" 
                >
                    <img src="./images/index/icon1a.png" />
                </a>
                <a 
                    href="./page_herramientas.php" 
                    class="col-md-12 link-icon" 
                    data-img="./images/index/icon2a.png"
                    data-imghover="./images/index/icon2b.png" 
                >
                    <img src="./images/index/icon2a.png" />
                </a>
                <a 
                    href="./indicadores.php" 
                    class="col-md-12 link-icon" 
                    data-img="./images/index/icon3a.png"
                    data-imghover="./images/index/icon3b.png" 
                >
                    <img src="./images/index/icon3a.png" />
                </a>
                <a 
                    href="./estadisticas.php" 
                    class="col-md-12 link-icon" 
                    data-img="./images/index/icon4a.png"
                    data-imghover="./images/index/icon4b.png" 
                >
                    <img src="./images/index/icon4a.png" />
                </a>
            </div>
        </div>
    </div>

    <div class="modal fade" id="uxVideo" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content video-container">
                <video width="800" height="450" controls poster="image">
                    <source src="http://observatorio.atic.com.ar/video_3d/LB_3.mp4" type="video/mp4" />
                    Tu navegador no soporta reproducir este video.
                </video>
                <div id="uxVideoClose">
                    <i class="fa fa-times fa-2x"></i>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="./js/hc-sticky.js" type="text/javascript"></script>
<script type='text/javascript'>
$(document).ready(function() {
    var model = {
        apiUrlBase: GlobalApiUrl,
        sensores: [],
        sensorIndex: 0,
        noticias: [],
        noticiasxslide: 4
    };

    $('.pinned').hcSticky({
        stickTo: '.side-right',
        top: 80
    });

    $.getJSON(model.apiUrlBase + '/mediateca_noticias_index.php', function(data) {
        model.noticias = data;

        let slides_qty = (Math.trunc((data.length) / model.noticiasxslide)) + 1;
        let html = '';

        // html += '<ol class="carousel-indicators">';
        // for(let index = 0; index < slides_qty; index++) {
        //     html += `<li data-target="#noticias-slider" data-slide-to="${index}" ${index == 0 ? 'class="active"' : ''}></li>`;
        // };
        // html += '</ol>'

        html += '<div class="carousel-inner">';
        for (let index = 0; index < slides_qty; index++) {
            let base = index * model.noticiasxslide;
            html += `<div class="carousel-item ${index == 0 ? 'active' : ''}">`;

            for (let i = 0; i < model.noticiasxslide; i++) {
                if (base + i < model.noticias.length) {
                    let n = model.noticias[base + i];
                    html += `
                            <a target="_blank" href="${n.path_pdf}" class="noticia-item" style="width: ${100 / model.noticiasxslide}% ; background-image: url(${n.path_img}?${Math.floor((Math.random() * 10000) + 1)});">
                                <div class="noticia-caption" style="width: ${100 / model.noticiasxslide}% ;">
                                    <p style="margin-bottom: 20px;">
                                        ${n.titulo}
                                    </p>
                                    <p style="font-size: 14px; font-weight: normal; text-align: right; margin-bottom: 4px;">
                                        ${moment(n.fecha).format('DD [de] MMMM [de] YYYY')}
                                    </p>
                                </div>                
                            </a>
                        `;
                }
            }

            if (index + 1 == slides_qty) {
                html += `
                            <a target="_blank" href="./mediateca.php?solapa=3&o=4" class="noticia-item" style="background-color: #fff;">
                                <div class="noticia-caption2" style="width: ${100 / model.noticiasxslide}% ;">
                                    <p>
                                        Ver m&aacute;s<br />
                                        Noticias
                                    </p>
                                </div>                
                            </a>
                        `;
            }

            html += `</div>`;
        };
        html += '</div>'

        html += `
                <div class="carousel-control-prev2" href="#noticias-slider" role="button" data-slide="prev">
                    <i class="fa fa-chevron-left"></i>
                </div>
                <div class="carousel-control-next2" href="#noticias-slider" role="button" data-slide="next">
                    <i class="fa fa-chevron-right"></i>
                </div>
            `;

        $('#noticias-slider').html(html);
    });

    $.getJSON(model.apiUrlBase + '/json_sensores.php', function(data) {
        model.sensores = data;
        sensorRefresh();
        setInterval(
            function() {
                sensorRefresh();
            },
            2000
        );
    });

    function sensorRefresh() {
        let sensor = model.sensores[model.sensorIndex];
        let html = `
                <div class='sensor-estacion'>${sensor.estacion}</div>
                <div class='sensor-tipo'>${sensor.tipo}</div>
                <div class='sensor-nombre'>${sensor.dato_nombre}</div>
                <div class='sensor-dato'>${sensor.dato} <span class='sensor-unidad'>${sensor.unidad}</span></div>
                <div class='sensor-min'>Min: <b>${sensor.minimo} *</b></div>
                <div class='sensor-med'>Med: <b>${sensor.media} *</b></div>
                <div class='sensor-max'>Max: <b>${sensor.maximo} *</b></div>
                <div class='sensor-leyenda'>*Valores medidos entre el ${moment(sensor.fecha_inicial).format('DD/MM/YYYY')} y el ${moment(sensor.ultima_act).format('DD/MM/YYYY')}</div>
            `
        $('#uxSensor').html(html);

        model.sensorIndex++;
        if (model.sensorIndex >= model.sensores.length)
            model.sensorIndex = 0;
    }

    $('#uxVideo2').hover(
        function() { this.play(); },
        function() { this.pause(); }
    ).on('click', function() {
        window.location.href = "./page_proyecto.php";
    });

    $('.carousel-item').hover(
        function() {
            $(this).find('.carousel-caption').hide();
            $(this).find('.slide-hover').css('display', 'flex');
        },
        function() {
            $(this).find('.slide-hover').hide();
            $(this).find('.carousel-caption').show();
        }
    )

    $('.modulo-wrap').hover(
        function() {
            $(this).find('.modulo-text').hide();
        },
        function() {
            $(this).find('.modulo-text').show();
        }
    )

    $('.link-icon').hover(
        function() {
            let icon = $(this).find('img');
            icon.attr('src', $(this).data('imghover'));
        },
        function() {
            let icon = $(this).find('img');
            icon.attr('src', $(this).data('img'));
        }
    )

    refreshUI();
    $(window).resize(function() {
        refreshUI();
    });

    function refreshUI() {
        $('#page_index').width($(window).width() > 1400 ? 1400 : $(window).width());
    }

   /*  setInterval(() => {
        refreshUI();
    }, 500); */

});
</script>