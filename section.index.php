<div id="page_index">
    <div id="main-slider" class="carousel slide" data-ride="carousel" data-interval="3000">
        <ol class="carousel-indicators">
            <li data-target="#main-slider" data-slide-to="0" class="active"></li>
            <li data-target="#main-slider" data-slide-to="1"></li>
            <li data-target="#main-slider" data-slide-to="2"></li>
            <li data-target="#main-slider" data-slide-to="3"></li>
            <li data-target="#main-slider" data-slide-to="4"></li>
            <li data-target="#main-slider" data-slide-to="5"></li>
        </ol>
        <div class="carousel-inner">
            <a href="./page_pdga.php" class="carousel-item active">
                <img class="d-block w-100" src="./images/index/s1.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Energía renovable</p>
                </div>                
                <div class="slide-hover">
                    Cóndor Cliff y La Barrancosa aportarán energía renovable para todo el país, aumentando en un 12% la potencia hidráulica instalada.
                </div>
            </a>
            
            <!-- Link: PGA-Estructura del PGA-Glaciares -->
            <a href="#" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s2.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Protección de glaciares</p>
                </div>                
                <div class="slide-hover">
                    El desacople hidráulico entre Cóndor Cliff y el Lago Argentino protege a los glaciares de las fluctuaciones del embalse.
                </div>
            </a>
            
            <!-- Link: PGA-Estructura del PGA-Aves -->
            <a href="#" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s3.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Macá tobiano</p>
                </div>                
                <div class="slide-hover">
                    La operación de La Barrancosa no afectará al estuario del río Santa Cruz, preservando de esta manera la zona de invernada del macá tobiano.
                </div>
            </a>

            <!-- Link: PGA-Estructura del PGA-Ictiofauna -->
            <a href="#" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s4.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Peces del Santa Cruz</p>
                </div>                
                <div class="slide-hover">
                    Los estudios sobre lamprea y otras especies aportan información para conservar a las poblaciones de peces y a la pesca como una actividad de relevancia.
                </div>
            </a>
            
            <!-- Link: PGA-ARTICULACIÓN INSTITUCIONAL -->
            <a href="#" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s5.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Participación pública</p>
                </div>                
                <div class="slide-hover">
                    El acceso a la información y el trabajo articulado con las instituciones locales permiten involucrar a todos los sectores sociales interesados en el proyecto.
                </div>
            </a>

            <!-- Link: PGA-Estructura del PGA-Aspectos socioeconómicos -->
            <a href="#" class="carousel-item">
                <img class="d-block w-100" src="./images/index/s6.jpg" alt="...">
                <div class="carousel-caption">
                    <p>Desarrollo regional</p>
                </div>                
                <div class="slide-hover">
                    La ejecución de las obras, la mayor disponibilidad de energía y los recursos técnicos que se incorporan en la provincia fortalecen las perspectivas de desarrollo.
                </div>
            </a>
        </div>

        <div class="carousel-control-prev2" href="#main-slider" role="button" data-slide="prev">
            <i class="fa fa-chevron-left"></i>
        </div>
        <div class="carousel-control-next2" href="#main-slider" role="button" data-slide="next">
            <i class="fa fa-chevron-right"></i>
        </div>
    </div>


    <div class="row">
        <div class="col-md-10">
            <div class="row modulo-row">
                <a href="./page.php" class="col-md-6 modulo-wrap modulo-1">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        IEASA EN EL TERRITORIO
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Mapa de proyectos, obras en construcción y operación de IEASA.
                            <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>
                <a href="#" class="col-md-6 modulo-wrap modulo-2">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        OBSERVATORIO AHRSC
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Ámbito de estudio y evaluación de la información estratégica de los AHRSC desde el punto de vista ambiental y del proyecto. Proporciona distintos instrumentos que facilitan el acceso y la divulgación pública del conocimiento para la implementación de una gestión sostenible.
                            <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>
            </div>
            <div class="row modulo-row">

                <div id="noticias-slider" class="carousel slide" data-ride="false" data-interval="false"></div>

                <div class="video-hover col-md-6 modulo-wrap modulo-7">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        EXPLORA LAS OBRAS DE LOS AHRSC EN 2D Y 3D
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            <i class="fa fa-play-circle fa-4x"></i>
                        </p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="row">
                        <a href="./page.php" class="col-md-12 modulo-wrap modulo-4">
                            <div class="modulo-opacity"></div>
                            <div class="modulo-text">
                                HIGIENE Y SEGURIDAD LABORAL
                            </div>
                            <div class="modulo-hover">
                                <p class="modulo-hover-text">
                                    Acciones de prevención de riesgos del trabajo.
                                    <br />
                                    <span class="modulo-hover-icon">
                                        <i class="fa fa-plus-circle fa-2x"></i>
</span>
                                </p>
                            </div>
                        </a>
                        <a href="./geovisor.php" class="col-md-12 modulo-wrap modulo-5">
                            <div class="modulo-opacity"></div>
                            <div class="modulo-text">
                                PLAN DE GESTIÓN DE CALIDAD
                            </div>
                            <div class="modulo-hover">
                                <p class="modulo-hover-text">
                                    Accedé al Plan de Gestión de Calidad  de las obras.
                                    <br />
                                    <span class="modulo-hover-icon">
                                        <i class="fa fa-plus-circle fa-2x"></i>
                                    </span>
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <div class="row modulo-row">
                <div class="col-md-6">
                    <div class="row">
                        <a href="./page_pdga.php" class="col-md-12 modulo-wrap modulo-10">
                            <div class="modulo-opacity"></div>
                            <div class="modulo-text">
                                PLAN DE GESTIÓN AMBIENTAL<br />
                                (PGA - AHRSC)
                            </div>
                            <div class="modulo-hover">
                                <p class="modulo-hover-text">
                                    Facilita el seguimiento de las acciones que brindan sostenibilidad al proyecto en sus distintas etapas. Planifica y ejecuta monitoreos sistemáticos para  el estudio de la evolución del ambiente.
                                    <br />
                                    <span class="modulo-hover-icon">
                                        <i class="fa fa-plus-circle fa-2x"></i>
                                    </span>
                                </p>
                            </div>
                        </a>
                    </div>
                </div>
                <a href="./page_ahrsc.php" class="col-md-6 modulo-wrap modulo-8">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        APROVECHAMIENTOS HIDROELÉCTRICOS DEL RÍO SANTA CRUZ
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Ingresá a la información del proyecto de las presas Cóndor Cliff (CC) y La Barrancosa (LB), que proveerán electricidad al Sistema Argentino de Interconexión (SADI).
                            <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>
            </div>
            <div class="row modulo-row border-bottom">
                <div class="col-md-4 modulo-wrap modulo-9">
                    <div id="uxSensor"></div>
                </div>
                <a href="./page.php" class="col-md-4 modulo-wrap modulo-6">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        COMUNICACIÓN Y GESTIÓN PARTICIPATIVA
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Acciones de comunicación, relación con actores sociales y participación comunitaria.
                            <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>
                <a target="_blank" href="http://hidrosantacruz.com.ar" class="col-md-4 modulo-wrap modulo-11">
                    <div class="modulo-opacity"></div>
                    <div class="modulo-text">
                        SIG SANTA CRUZ
                    </div>
                    <div class="modulo-hover">
                        <p class="modulo-hover-text">
                            Información espacial de la provincia de Santa Cruz, orientada a la gestión, análisis y ajuste de políticas en campos específicos de interés para la administración pública (...)
                            <br />
                            <span class="modulo-hover-icon">
                                <i class="fa fa-plus-circle fa-2x"></i>
                            </span>
                        </p>
                    </div>
                </a>
            </div>
        </div>
        <div class="col-md-2 side-right" style="position: relative;">
            <div class="row pinned" style="position: absolute;">
                <a 
                    href="./mediateca.php" 
                    class="col-md-12 link-wrap link-1"
                    data-img="./images/icono_mediateca.png"
                    data-imghover="./images/icono_mediateca_hover.png"
                    data-css="link-1"
                    data-csshover="link-1-hover"
                >
                    <div class="link-icon">
                        <img src="./images/icono_mediateca.png" />
                    </div>
                    <div class="link-text" style="display: none;">
                        MEDIATECA
                    </div>
                </a>
                <a 
                    href="./page_herramientas.php" 
                    class="col-md-12 link-wrap link-2"
                    data-img="./images/icono_geovisores.png"
                    data-imghover="./images/icono_geovisores_hover.png"
                    data-css="link-2"
                    data-csshover="link-2-hover"
                >
                    <div class="link-icon">
                        <img src="./images/icono_geovisores.png" />
                    </div>
                    <div class="link-text" style="display: none;">
                        GEOVISORES
                    </div>
                </a>
                <a 
                    href="./indicadores.php" 
                    class="col-md-12 link-wrap link-3"
                    data-img="./images/icono_indicadores.png"
                    data-imghover="./images/icono_indicadores_hover.png"
                    data-css="link-3"
                    data-csshover="link-3-hover"
                >
                    <div class="link-icon">
                        <img src="./images/icono_indicadores.png" />
                    </div>
                    <div class="link-text" style="display: none;">
                        INDICADORES
                    </div>
                </a>
                <a 
                    href="./estadisticas.php" 
                    class="col-md-12 link-wrap link-4"
                    data-img="./images/icono_estadisticas.png"
                    data-imghover="./images/icono_estadisticas_hover.png"
                    data-css="link-4"
                    data-csshover="link-4-hover"
                >
                    <div class="link-icon">
                        <img src="./images/icono_estadisticas.png" />
                    </div>
                    <div class="link-text" style="display: none;">
                        ESTADISTICAS
                    </div>
                </a>
            </div>
        </div>
    </div>

    <div class="modal fade" id="uxVideo" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
            <div class="modal-content video-container">
                <video width="800" height="450" controls poster="image">
                    <source src="http://observatorio.atic.com.ar/video_3d/LB_3.mp4" type="video/mp4" />
                    Tu navegador no soporta reproducir este video.
                </video>
                <div id="uxVideoClose">
                    <i class="fa fa-times fa-2x"></i>
                </div>
            </div>
        </div>
    </div>
</div>
    
<script src="./js/hc-sticky.js" type="text/javascript"></script>
<script type='text/javascript'>
    $(document).ready(function () {
        var model = {
            apiUrlBase: 'http://observatorio.ieasa.com.ar',
            sensores: [],
            sensorIndex : 0,
            noticias: []
        };

        $('.pinned').hcSticky({
            stickTo: '.side-right',
            top: 80
        });

        $.getJSON(model.apiUrlBase + '/mediateca_noticias_index.php', function(data) {
            model.noticias = data;
            let slides_qty = Math.trunc((data.length + 1) / 3);

            let html = '';
            
            // html += '<ol class="carousel-indicators">';
            // for(let index = 0; index < slides_qty; index++) {
            //     html += `<li data-target="#noticias-slider" data-slide-to="${index}" ${index == 0 ? 'class="active"' : ''}></li>`;
            // };
            // html += '</ol>'

            html += '<div class="carousel-inner">';
            for(let index = 0; index < slides_qty; index++) {
                let base = index * 3;
                html += `<div class="carousel-item ${index == 0 ? 'active' : ''}">`;

                for(let i = 0; i < 3; i++) {
                    if (base + i < model.noticias.length) {
                        let n = model.noticias[base + i];
                        html += `
                            <div class="noticia-item" style="background-image: url(${n.path_img}?${Math.floor((Math.random() * 10000) + 1)});">
                                <div class="noticia-caption">
                                    <p>
                                        ${n.titulo}
                                        <br />
                                        <span style="font-size: 16px; font-weight: normal;">
                                            ${moment(n.fecha).format('DD [de] MMMM [de] YYYY')}
                                        </span>
                                    </p>
                                </div>                
                            </div>
                        `;
                    }
                }

                if (index + 1 == slides_qty) {
                        html += `
                            <a target="_blank" href="./mediateca.php?solapa=3" class="noticia-item">
                                <div class="noticia-caption2">
                                    <p>
                                        Ver m&aacute;s<br />
                                        Noticias
                                    </p>
                                </div>                
                            </a>
                        `;
                }


                html += `</div>`;
            };
            html += '</div>'

            html += `
                <div class="carousel-control-prev" href="#noticias-slider" role="button" data-slide="prev">
                    <i class="fa fa-chevron-left"></i>
                </div>
                <div class="carousel-control-next" href="#noticias-slider" role="button" data-slide="next">
                    <i class="fa fa-chevron-right"></i>
                </div>
            `;

            $('#noticias-slider').html(html);
        });

        $.getJSON(model.apiUrlBase + '/json_sensores.php', function(data) {
            model.sensores = data;
            sensorRefresh();
            setInterval(
                function() { 
                    sensorRefresh();
                }, 
                2000
            );
        });

        function sensorRefresh() {
            let sensor = model.sensores[model.sensorIndex];
            let html = `
                <div class='sensor-estacion'>${sensor.estacion}</div>
                <div class='sensor-tipo'>${sensor.tipo}</div>
                <div class='sensor-fecha'>&Uacute;ltimo reg.: ${moment(sensor.ultima_act).format('DD [de] MMM [de] YYYY HH:mm:ss')}</div>
                <div class='sensor-nombre'>${sensor.dato_nombre}</div>
                <div class='sensor-dato'>${sensor.dato} <span class='sensor-unidad'>${sensor.unidad}</span></div>
                <div class='sensor-min'>Min: <b>${sensor.minimo} *</b></div>
                <div class='sensor-med'>Med: <b>${sensor.media} *</b></div>
                <div class='sensor-max'>Max: <b>${sensor.maximo} *</b></div>
                <div class='sensor-leyenda'>*Son valores medidos en los &uacute;ltimos 30 d&iacute;as</b></div>
            `
            $('#uxSensor').html(html);

            model.sensorIndex++;
            if (model.sensorIndex >= model.sensores.length)
                model.sensorIndex = 0;
        }

        $('.video-hover').on('click', function() {
            $('#uxVideo').modal('show');
            $('#uxVideo video')[0].play();
        });

        $('#uxVideo').on('hidden.bs.modal', function () {
            $('#uxVideo video')[0].pause();
        })

        $('#uxVideoClose').on('click', function() {
            $('#uxVideo video')[0].pause();
            $('#uxVideo').modal('hide');
        });

        $('.carousel-item').hover( 
            function () {
                $(this).find('.carousel-caption').hide();
                $(this).find('.slide-hover').css('display', 'flex');
            },
            function () {
                $(this).find('.slide-hover').hide();
                $(this).find('.carousel-caption').show();
            }
        )
        $('.modulo-wrap').hover( 
            function () {
                $(this).find('.modulo-text').hide();
            },
            function () {
                $(this).find('.modulo-text').show();
            }
        )

        $('.link-wrap').hover( 
            function () {
                let icon = $(this).find('.link-icon img');
                icon.attr('src', $(this).data('imghover'));
                $(this).removeClass($(this).data('css'));
                $(this).addClass($(this).data('csshover'));
                $(this).find('.link-text').show();
            },
            function () {
                let icon = $(this).find('.link-icon img');
                icon.attr('src', $(this).data('img'));
                $(this).removeClass($(this).data('csshover'));
                $(this).addClass($(this).data('css'));
                $(this).find('.link-text').hide();
            }
        )

        refreshUI();
        $(window).resize(function() {
            refreshUI();
        });

        function refreshUI() {
            let w = $('.link-wrap').first().outerWidth();
            $('.link-wrap').height(w);
        }

        setTimeout(() => {
            refreshUI();
        }, 500);

    });
</script>